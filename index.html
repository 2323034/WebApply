<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰ç›®ä¸¦ã¹ã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ«ã§Xã¨Oã®è‰²ã‚’èª¿æ•´ */
        .player-x {
            color: #3b82f6; /* Tailwind blue-500 */
        }
        .player-o {
            color: #ec4899; /* Tailwind pink-500 */
        }
        .winning-cell {
            background-color: #a7f3d0; /* Tailwind green-200 */
        }
        /* ãƒœã‚¿ãƒ³ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒªãƒ³ã‚°ã‚’å°‘ã—ç›®ç«‹ãŸã›ã‚‹ */
        .cell-button:focus, #resetButton:focus, #closeMessageButton:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4); /* blue-500 with opacity */
        }
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’æ»‘ã‚‰ã‹ã« */
        #messageBox {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        #messageBox.hidden {
            opacity: 0;
            visibility: hidden;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 bg-white rounded-xl shadow-2xl w-full max-w-lg">
        <h1 class="text-3xl sm:text-4xl font-bold mb-6 sm:mb-8 text-center text-gray-800">ä¸‰ç›®ä¸¦ã¹ã‚²ãƒ¼ãƒ </h1>
        
        <div id="statusArea" class="text-xl sm:text-2xl mb-6 text-center font-semibold text-gray-700 h-8">
            </div>

        <div id="gameBoard" class="grid grid-cols-3 gap-2 w-full max-w-xs sm:max-w-sm mx-auto aspect-square rounded-lg overflow-hidden shadow-lg">
            </div>

        <button id="resetButton" class="mt-8 w-full max-w-xs sm:max-w-sm mx-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:bg-blue-700 transition duration-150 ease-in-out text-lg">
            ãƒªã‚»ãƒƒãƒˆ
        </button>
    </div>

    <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden">
        <div class="bg-white p-6 sm:p-8 rounded-lg shadow-xl text-center w-full max-w-sm">
            <p id="messageText" class="text-lg sm:text-xl mb-6 text-gray-700"></p>
            <button id="closeMessageButton" class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:bg-blue-700 transition duration-150 ease-in-out">
                OK
            </button>
        </div>
    </div>

    <script>
        // DOMè¦ç´ ã®å–å¾—
        const statusDisplay = document.getElementById('statusArea');
        const gameBoardElement = document.getElementById('gameBoard');
        const resetButton = document.getElementById('resetButton');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');
        const closeMessageButton = document.getElementById('closeMessageButton');

        // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã«é–¢ã™ã‚‹å¤‰æ•°
        let currentPlayer = 'X'; // ç¾åœ¨ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ (X ã¾ãŸã¯ O)
        let board = ['', '', '', '', '', '', '', '', '']; // 9ã¤ã®ã‚»ãƒ«ã«å¯¾å¿œã™ã‚‹ç›¤é¢ã®çŠ¶æ…‹
        let isGameActive = true; // ã‚²ãƒ¼ãƒ ãŒé€²è¡Œä¸­ã‹ã©ã†ã‹
        const cells = []; // ã‚»ãƒ«è¦ç´ ã‚’æ ¼ç´ã™ã‚‹é…åˆ—

        // å‹åˆ©æ¡ä»¶ã®å®šç¾© (ç›¤é¢ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å¯¾å¿œ)
        const winningConditions = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8], // æ¨ªã®åˆ—
            [0, 3, 6], [1, 4, 7], [2, 5, 8], // ç¸¦ã®åˆ—
            [0, 4, 8], [2, 4, 6]             // æ–œã‚ã®åˆ—
        ];

        // ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–é–¢æ•°
        function initializeGame() {
            currentPlayer = 'X';
            board.fill('');
            isGameActive = true;
            statusDisplay.textContent = `ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ ${currentPlayer} ã®ç•ªã§ã™`;
            
            // æ—¢å­˜ã®ã‚»ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã€æ–°ã—ã„ã‚»ãƒ«ã‚’ç”Ÿæˆ (åˆå›ã®ã¿ç”Ÿæˆ)
            if (cells.length === 0) {
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('button');
                    cell.classList.add(
                        'cell-button', // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«ç”¨
                        'bg-white', 
                        'border', 'border-gray-300',
                        'text-5xl', 'sm:text-6xl', 'font-bold', 
                        'flex', 'items-center', 'justify-center',
                        'hover:bg-gray-100', 
                        'transition', 'duration-150', 'ease-in-out',
                        'aspect-square', // ã‚»ãƒ«ã‚’æ­£æ–¹å½¢ã«ä¿ã¤
                        'focus:outline-none' // Tailwindã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å‰Šé™¤
                    );
                    cell.dataset.index = i;
                    cell.addEventListener('click', handleCellClick);
                    gameBoardElement.appendChild(cell);
                    cells.push(cell);
                }
            } else {
                // 2å›ç›®ä»¥é™ã¯ã‚»ãƒ«ã®å†…å®¹ã¨çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                cells.forEach(cell => {
                    cell.textContent = '';
                    cell.disabled = false;
                    cell.classList.remove('player-x', 'player-o', 'winning-cell');
                });
            }
        }

        // ã‚»ãƒ«ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
        function handleCellClick(event) {
            const clickedCell = event.target;
            const clickedCellIndex = parseInt(clickedCell.dataset.index);

            // ã‚»ãƒ«ãŒæ—¢ã«åŸ‹ã¾ã£ã¦ã„ã‚‹ã‹ã€ã‚²ãƒ¼ãƒ ãŒçµ‚äº†ã—ã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚ã—ãªã„
            if (board[clickedCellIndex] !== '' || !isGameActive) {
                return;
            }

            // ç›¤é¢ã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã€ã‚»ãƒ«ã«ãƒãƒ¼ã‚¯ã‚’è¡¨ç¤º
            board[clickedCellIndex] = currentPlayer;
            clickedCell.textContent = currentPlayer;
            clickedCell.disabled = true; // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚»ãƒ«ã‚’ç„¡åŠ¹åŒ–
            clickedCell.classList.add(currentPlayer === 'X' ? 'player-x' : 'player-o');

            // å‹æ•—ã‚’ãƒã‚§ãƒƒã‚¯
            checkResult();
        }

        // å‹æ•—ã¨å¼•ãåˆ†ã‘ã®ãƒã‚§ãƒƒã‚¯é–¢æ•°
        function checkResult() {
            let roundWon = false;
            let winningCombination = null;

            for (let i = 0; i < winningConditions.length; i++) {
                const winCondition = winningConditions[i];
                const a = board[winCondition[0]];
                const b = board[winCondition[1]];
                const c = board[winCondition[2]];

                if (a === '' || b === '' || c === '') {
                    continue; // ã„ãšã‚Œã‹ã®ã‚»ãƒ«ãŒç©ºãªã‚‰ã€ã“ã®çµ„ã¿åˆã‚ã›ã§ã¯å‹åˆ©ã§ã¯ãªã„
                }
                if (a === b && b === c) {
                    roundWon = true; // 3ã¤ã®ã‚»ãƒ«ãŒåŒã˜ãƒãƒ¼ã‚¯ãªã‚‰å‹åˆ©
                    winningCombination = winCondition;
                    break;
                }
            }

            if (roundWon) {
                statusDisplay.textContent = ''; // å‹æ•—ãŒæ±ºã¾ã£ãŸã‚‰ã‚¿ãƒ¼ãƒ³è¡¨ç¤ºã¯æ¶ˆã™
                showCustomMessage(`ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ ${currentPlayer} ã®å‹ã¡ã§ã™ï¼ ğŸ‰`);
                isGameActive = false;
                // å‹åˆ©ã—ãŸã‚»ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                if (winningCombination) {
                    winningCombination.forEach(index => {
                        cells[index].classList.add('winning-cell');
                    });
                }
                return;
            }

            // å…¨ã¦ã®ã‚»ãƒ«ãŒåŸ‹ã¾ã£ã¦ã„ã‚‹ã‹ (å¼•ãåˆ†ã‘ã®ãƒã‚§ãƒƒã‚¯)
            if (!board.includes('')) {
                statusDisplay.textContent = '';
                showCustomMessage('å¼•ãåˆ†ã‘ã§ã™ï¼ ğŸ¤');
                isGameActive = false;
                return;
            }

            // ã‚²ãƒ¼ãƒ ãŒç¶šãå ´åˆã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’äº¤ä»£
            changePlayer();
        }

        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’äº¤ä»£ã™ã‚‹é–¢æ•°
        function changePlayer() {
            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            statusDisplay.textContent = `ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ ${currentPlayer} ã®ç•ªã§ã™`;
        }

        // ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°
        function resetGame() {
            initializeGame(); // ã‚²ãƒ¼ãƒ ã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        }

        // ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showCustomMessage(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        // ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é–‰ã˜ã‚‹é–¢æ•°
        function closeCustomMessage() {
            messageBox.classList.add('hidden');
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        resetButton.addEventListener('click', resetGame);
        closeMessageButton.addEventListener('click', closeCustomMessage);

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        initializeGame();
    </script>

</body>
</html>
